#! /usr/bin/env bash

# TODO: blur value should percentage of image size
#   or even better based on high/low frequency distribution

for file in "$@"
do
  convert \
    -verbose \
    "$file" \
    -alpha off \
    \( +clone -blur 0x60 -brightness-contrast 40 \) \
    -compose minus \
    -composite \
    -negate \
    -auto-threshold otsu \
    "${file%.*}"-binarized.png
done
